# Patch to update customer's header information for serving #2901 - #3150
# by "Jerry Guo <hozaka@gmail.com>"
#
# Usage:
# Load this script in Rails Console.

require 'fastercsv'

data = <<EOF
Customer,Camera,SubTotal,Shipping,Tax,Balance,Transfer Amt
CU 0103226,5273,30286,598.49,0,4699,26185.49
CU 0103381,5274,22850,185.29,2022.23,1750,23307.52
CU 0103897,4853,50112,598.49,0,2245,48465.49
CU 0101868,4751,27020,598.49,0,212.28,27406.21
CU 0100602,"4753, 4761, 4770, 4775, 4776, 4777, 4854, 4855, 5040",473722,598.49,0,243351.84,230968.65
CU 0103834,"4754, 4755",86538,598.49,0,8215,78921.49
CU 0103836,4756,17500,185.29,0,1750,15935.29
CU 0100329,4758,25250,598.49,0,0,25848.49
CU 0103839,4760,17500,185.29,1548.75,1750,17484.04
CU 0103840,4762,43095,185.29,3813.91,23327,23767.2
CU 0103841,4763,28795,185.29,2548.36,2879.5,28649.15
CU 0100480,4764,17500,598.49,0,0,18098.49
CU 0103842,4765,17500,185.29,1548.75,1750,17484.04
CU 0103843,4766,39460,598.49,0,3946,36112.49
CU 0103845,4768,25129,598.49,0,0,25727.49
CU 0103847,4774,17500,185.29,1548.75,1750,17484.04
CU 0101213,"4778, 4862",89890,598.49,0,4424.65,86063.84
CU 0103848,4779,18750,598.49,0,1875,17473.49
CU 0103851,"4782, 4783",59987,598.49,0,5998.7,54586.79
CU 0103852,4784,33449,185.29,0,1875,31759.29
CU 0103853,4785,17500,598.49,0,1750,16348.49
CU 0103854,4786,17500,598.49,0,1735,16363.49
CU 0103857,4788,27647,598.49,0,1750,26495.49
CU 0103858,4789,43609,598.49,0,4360.9,39846.59
CU 0103859,4790,17500,598.49,0,514.06,17584.43
CU 0103860,4791,29585,598.49,0,1723,28460.49
CU 0101406,4792,58025,598.49,0,34083.48,24540.01
CU 0101227,"4795, 4796, 4797, 4798",81350,185.29,7199.48,100,88634.77
CU 0103307,4799,49619,598.49,0,5000,45217.49
CU 0103863,4800,30440,185.29,0,3086.02,27539.27
CU 0103867,4805,17500,185.29,0,1750,15935.29
CU 0103869,4807,17500,598.49,0,0,18098.49
CU 0103870,4808,17500,185.29,1548.75,1750,17484.04
CU 0103871,4809,35650,185.29,3155.03,1750,37240.32
CU 0103872,"4810, 5077",44509,598.49,0,4122.9,40984.59
CU 0103874,4811,18750,185.29,0,1875,17060.29
CU 0103468,"4812, 4813, 4921, 4922",82050,598.49,0,-21012.91,103661.4
CU 0103861,4793,31700,598.49,0,3080,29218.49
CU 0103868,4806,45412,185.29,4018.96,49364.7,251.55
CU 0103878,"4816, 4817, 4818",52500,185.29,4646.25,0,57331.54
CU 0103880,4822,52373,598.49,0,1750,51221.49
CU 0103882,"4830, 4831, 4832",52500,598.49,0,5232,47866.49
CU 0101673,"4833, 4991, 4992",54700,598.49,0,640.38,54658.11
CU 0103883,"4836, 4840, 4841",54875,185.29,0,2578.76,52481.53
CU 0103887,4839,48237,598.49,0,4823.7,44011.79
CU 0101845,"4842, 4843",35000,598.49,0,0,35598.49
CU 0103889,4845,18750,185.29,1781.25,1875,18841.54
CU 0102672,4850,42255,598.49,0,0,42853.49
CU 0103898,4856,41958,598.49,0,4195.8,38360.69
CU 0103899,4857,54100,598.49,0,0,54698.49
CU 0102068,"4858, 4859",46575,598.49,0,252.51,46920.98
CU 0102029,4860,48550,598.49,0,0,49148.49
CU 0103902,4863,44835,598.49,0,0,45433.49
CU 0103903,4864,17500,185.29,0,1750,15935.29
CU 0103583,4869,21845,185.29,1933.28,4726.83,19236.74
CU 0101548,"4870, 4871",36800,598.49,0,5349,32049.49
CU 0103910,4874,18000,598.49,0,1800,16798.49
CU 0101494,"4877, 4878",73605,598.49,0,7000.03,67203.46
CU 0103917,4883,46200,598.49,0,0,46798.49
CU 0103920,4885,17500,185.29,1548.75,1750,17484.04
CU 0103921,4886,17500,185.29,0,1750,15935.29
CU 0101460,4887,40697,185.29,0,3359.7,37522.59
CU 0103922,4888,17500,598.49,0,1750,16348.49
CU 0103923,4889,18000,598.49,0,2250,16348.49
CU 0103924,"4890, 4891",35000,185.29,0,3500,31685.29
CU 0102352,4894,33165,598.49,0,3296.5,30466.99
CU 0103837,4757,18750,598.49,0,1875,17473.49
CU 0103838,4759,17500,598.49,0,1750,16348.49
CU 0103291,4771,20800,598.49,0,3350,18048.49
CU 0103850,4781,27475,185.29,0,1750,25910.29
CU 0103856,4787,17500,185.29,0,1750,15935.29
CU 0103895,4851,24195,598.49,0,1750,23043.49
CU 0101544,4880,17500,598.49,0,1750.78,16347.71
CU 0102052,"4895, 5135, 5136, 5137, 5138",184616,185.29,0,10500,174301.29
CU 0103928,4902,19250,185.29,1703.63,1925,19213.92
CU 0103931,"4905, 4906",37500,185.29,0,3750,33935.29
CU 0103933,4909,35897,598.49,0,1750,34745.49
CU 0103934,4910,36317,598.49,0,0,36915.49
CU 0101873,4911,23900,185.29,0,2518.18,21567.11
CU 0100791,4913,18210,185.29,1729.95,1572.5,18552.74
CU 0103936,4914,24950,598.49,0,1750,23798.49
CU 0103939,4915,38750,185.29,3429.38,3875,38489.67
CU 0102351,"4908, 4916",40750,598.49,0,2037.5,39310.99
CU 0103942,4919,33026,598.49,0,3600.35,30024.14
CU 0103950,4928,23800,185.29,0,1750,22235.29
CU 0103962,4943,36930,185.29,0,3703,33412.29
CU 0103952,4933,17500,185.29,0,1750,15935.29
CU 0103964,4946,41285,598.49,0,2290.5,39592.99
CU 0103484,4947,58892,598.49,0,7253.8,52236.69
CU 0103971,4961,17500,185.29,0,1750,15935.29
CU 0103973,4963,18750,598.49,0,1875,17473.49
CU 0103975,4965,22262,598.49,0,22626.49,234
CU 0103977,4969,35894,598.49,0,4239.4,32253.09
CU 0103042,"4970, 4971",68381,598.49,0,7000,61979.49
CU 0103979,4973,17500,185.29,0,1750,15935.29
CU 0103982,4975,17500,598.49,0,1750,16348.49
CU 0103984,4976,34283,598.49,0,3034.9,31846.59
CU 0103988,4982,35490,185.29,3140.87,3571,35245.16
CU 0100804,4983,29675,185.29,2626.24,1904.65,30581.88
CU 0103992,4985,18750,185.29,0,1875,17060.29
CU 0103994,4986,17500,185.29,1548.75,1750,17484.04
CU 0103996,4988,50214,598.49,0,5021.4,45791.09
CU 0101593,4990,32625,598.49,0,2903,30320.49
CU 0103844,"4767, 4823",81456,185.29,7208.86,84960.04,3890.11
CU 0103849,4780,25030,185.29,0,2578,22637.29
CU 0103892,"4847, 4848",83810,185.29,7417.19,8613.93,82798.55
CU 0103966,4949,31550,185.29,0,3155,28580.29
CU 0103991,4984,21154,185.29,1872.13,2115.4,21096.02
CU 0104001,4993,33648,185.29,0,3364.8,30468.49
CU 0104002,4994,29383,185.29,0,2898.5,26669.79
CU 0104008,5005,37039,598.49,0,3823.4,33814.09
CU 0103846,4769,17500,598.49,0,1750,16348.49
CU 0102113,4772,18600,185.29,0,1222.36,17562.93
CU 0103881,4829,17500,185.29,1548.75,1750,17484.04
CU 0101624,4838,21810,185.29,1930.19,1807.05,22118.43
CU 0103955,4936,35478,185.29,3370.41,3029,36004.7
CU 0104005,4996,31110,598.49,0,0,31708.49
CU 0103862,4794,24000,185.29,2124,2400,23909.29
CU 0103864,4801,17500,598.49,0,3500,14598.49
CU 0103865,"4803, 4804",46350,598.49,0,11350,35598.49
CU 0101822,4821,18650,598.49,0,2374.46,16874.03
CU 0103884,4837,17500,598.49,0,1725,16373.49
CU 0103891,4846,22700,598.49,0,0,23298.49
CU 0103893,4849,17500,185.29,1548.75,1750,17484.04
CU 0103896,4852,36881,598.49,0,2245,35234.49
CU 0103901,4861,27347,598.49,0,1750,26195.49
CU 0103907,4872,30350,598.49,0,0,30948.49
CU 0100768,"4881, 4882",35000,598.49,0,10,35588.49
CU 0103929,4903,36092,598.49,0,3339.2,33351.29
CU 0103930,4904,17500,598.49,0,1750,16348.49
CU 0103941,4918,18750,598.49,0,1875,17473.49
CU 0103943,4920,17500,598.49,0,1750,16348.49
CU 0103945,4926,18750,185.29,0,1875,17060.29
CU 0103947,4927,17500,598.49,0,0,18098.49
CU 0103958,4940,18750,598.49,0,1875,17473.49
CU 0103959,"4941, 4942",35000,185.29,0,3500,31685.29
CU 0103978,4972,53624,185.29,0,1750,52059.29
CU 0104004,4995,17500,598.49,0,1750,16348.49
CU 0104009,5006,40460,598.49,0,1750,39308.49
CU 0104027,5027,17500,598.49,0,1720,16378.49
CU 0104028,5028,49925,598.49,0,4992.5,45530.99
CU 0103877,4815,18750,598.49,0,1875,17473.49
CU 0103879,"4819, 4820",53033,598.49,0,5303.3,48328.19
CU 0103888,4844,54755,598.49,0,0,55353.49
CU 0103904,4866,60130,598.49,0,0,60728.49
CU 0104161,5232,47434,598.49,0,0,48032.49
CU 0103913,4876,61291,598.49,0,0,61889.49
CU 0103925,4893,32381,598.49,0,0,32979.49
CU 0102048,4912,18650,185.29,1650.53,1328.39,19157.43
CU 0103965,4948,27755,185.29,0,1750,26190.29
CU 0102197,4956,23400,185.29,0,14925,8660.29
CU 0100389,"4959, 4960",36100,598.49,0,4658.89,32039.6
CU 0103974,4964,29330,598.49,0,2853,27075.49
CU 0103985,"4977, 4978",47460,598.49,0,5638.5,42419.99
CU 0102891,4980,27250,185.29,2411.63,3030.85,26816.07
CU 0103995,4987,18000,185.29,0,1750,16435.29
CU 0103999,4989,17500,598.49,0,1750,16348.49
CU 0102504,"5000, 5194",60960,185.29,5394.96,25637.82,40902.43
CU 0104006,"5003, 5129, 5131",81943,598.49,0,0,82541.49
CU 0104007,5004,36700,598.49,0,3670,33628.49
CU 0104029,5034,41521,598.49,0,4152.1,37967.39
CU 0104030,5035,28650,598.49,0,2865,26383.49
CU 0104031,5036,17500,185.29,0,1750,15935.29
CU 0103927,4896,26162,185.29,0,2616.2,23731.09
CU 0101205,4907,39289,185.29,3477.08,2747.5,40203.87
CU 0103780,4932,39749,598.49,0,4791.9,35555.59
CU 0103954,4935,30966,185.29,2740.49,33532.39,359.39
CU 0103963,"4944, 4945",64913,598.49,0,6646.61,58864.88
CU 0103968,4958,29650,185.29,0,1750,28085.29
CU 0100426,"5238, 5239",85669,598.49,0,11234.12,75033.37
CU 0104048,5258,42430,185.29,3755.06,1750,44620.35
CU 0100645,4773,32095,598.49,0,3730.85,28962.64
CU 0102272,5320,29558,598.49,0,0,30156.49
CU 0101009,5219,19800,185.29,0,37.04,19948.25
CU 0104166,5242,30768,185.29,0,2758.6,28194.69
CU 0104168,5244,42973,598.49,0,3900,39671.49
CU 0104196,"5282, 5283",35000,598.49,0,3500,32098.49
CU 0104195,5281,21149,598.49,0,2114.9,19632.59
CU 0104198,"5284, 5287",46000,598.49,0,2350,44248.49
CU 0104201,5289,17500,598.49,0,0,18098.49
CU 0104209,5298,43237,598.49,0,43367,468.49
CU 0103957,5302,30367,598.49,0,0,30965.49
CU 0102086,5309,44550,185.29,3942.68,4455,44222.97
CU 0104216,"5310, 5311, 5312",99819,598.49,0,9982,90435.49
CU 0104219,5321,33395,598.49,0,3317.5,30675.99
CU 0104224,5324,28575,598.49,0,5250,23923.49
CU 0104223,5323,71185,185.29,0,0,71370.29
CU 0101591,"5107, 5108, 5109",189968,598.49,0,0,190566.49
CU 0102313,"5115, 5116",52700,598.49,0,1784,51514.49
CU 0104185,5270,23300,185.29,2062.05,8120,17427.34
CU 0104011,5008,20450,185.29,0,2045,18590.29
CU 0100989,"5012, 5013, 5014, 5051, 5052, 5053",164845,598.49,0,1719.52,163723.97
CU 0100635,5016,44325,598.49,0,15565.14,29358.35
CU 0104018,5018,38340,185.29,0,3834,34691.29
CU 0104020,5019,28908,598.49,0,2890.8,26615.69
CU 0102121,"5020, 5021, 5196, 5197",80000,598.49,0,17151.2,63447.29
CU 0104021,5022,18750,185.29,0,1875,17060.29
CU 0104024,5025,17500,598.49,0,1750,16348.49
CU 0104010,5007,26546,185.29,2349.32,2654.6,26426.01
CU 0101304,"5024, 5041",56800,598.49,0,0,57398.49
CU 0104036,5042,17500,185.29,1548.75,1750,17484.04
CU 0104037,5043,17500,598.49,0,1750,16348.49
CU 0104041,5050,45603,598.49,0,4560.3,41641.19
CU 0104049,5057,23550,185.29,0,3005,20730.29
CU 0101960,5060,35345,598.49,0,16027,19916.49
CU 0100030,"5062, 5063",37790,598.49,0,9790.69,28597.8
CU 0104058,5074,53810,598.49,0,0,54408.49
CU 0103466,5075,31871,185.29,2820.58,3625,31251.87
CU 0104066,"5080, 5081",35000,598.49,0,3500,32098.49
CU 0104069,"5083, 5084",35000,185.29,0,3500,31685.29
CU 0102006,"5085, 5124",59560,185.29,0,6512.36,53232.93
CU 0104074,5094,17500,185.29,1548.75,0,19234.04
CU 0104077,5100,40714,598.49,0,4976.4,36336.09
CU 0104078,5101,28740,598.49,0,0,29338.49
CU 0104086,5113,47485,185.29,0,0,47670.29
CU 0102174,5114,21600,598.49,0,22174.49,24
CU 0104092,5120,22900,598.49,0,2290,21208.49
CU 0100453,5122,35094,185.29,3105.82,3407.8,34977.31
CU 0104096,5123,30749,598.49,0,3010.9,28336.59
CU 0104098,5128,17500,598.49,0,0,18098.49
CU 0103260,"5132, 5133",61910,598.49,0,62478.49,30
CU 0104101,5134,17500,185.29,0,1750,15935.29
CU 0104109,5145,18000,598.49,0,1800,16798.49
CU 0103820,5151,28634,598.49,0,1772,27460.49
CU 0101721,5152,42775,598.49,0,12.97,43360.52
CU 0104111,5153,37821,598.49,0,1750,36669.49
CU 0104012,5009,17500,598.49,0,1750,16348.49
CU 0103644,5010,70796,598.49,0,59065.3,12329.19
CU 0104014,5011,30761,185.29,0,3834.4,27111.89
CU 0104017,5017,22543,598.49,0,2342.93,20798.56
CU 0100960,5038,18600,185.29,0,0,18785.29
CU 0101063,5049,26750,185.29,0,1000,25935.29
CU 0104044,5054,17500,598.49,0,1750,16348.49
CU 0104051,5061,23225,598.49,0,2322.5,21500.99
CU 0104052,5064,36680,598.49,0,37260.49,18
CU 0104057,5073,47099,598.49,0,4709.9,42987.59
CU 0104065,5079,17500,185.29,0,1750,15935.29
CU 0104068,5082,17500,598.49,0,1750,16348.49
CU 0104070,5088,36125,185.29,3197.06,2575,36932.35
CU 0104071,"5089, 5090",54555,598.49,0,4649.02,50504.47
CU 0104073,5092,46300,185.29,0,4630,41855.29
CU 0104076,"5096, 5097",35000,598.49,0,3500,32098.49
CU 0100987,"5098, 5099",46870,598.49,0,3500,43968.49
CU 0104081,5105,27300,185.29,0,2760,24725.29
CU 0104082,5106,50229,598.49,0,4046.9,46780.59
CU 0104084,5110,34105,598.49,0,2105,32598.49
CU 0104085,5111,27929,598.49,0,2792.9,25734.59
CU 0104035,5039,20769,185.29,0,1800,19154.29
CU 0104047,5056,17500,598.49,0,1750,16348.49
CU 0104062,5076,17500,185.29,1548.75,1750,17484.04
CU 0104072,5091,17500,598.49,0,1750,16348.49
CU 0104087,5112,25512,598.49,0,2551.2,23559.29
CU 0104089,5117,22448,185.29,1986.65,2244.8,22375.14
CU 0104090,5118,17500,598.49,0,1750,16348.49
CU 0104091,5119,17500,598.49,0,1750,16348.49
CU 0104094,5121,29610,185.29,0,2961,26834.29
CU 0104097,5125,18750,185.29,1781.25,1875,18841.54
CU 0102473,5126,31625,598.49,0,2577.83,29645.66
CU 0102621,5130,30995,598.49,0,2984.5,28608.99
CU 0104103,5141,23696,185.29,0,2369.6,21511.69
CU 0104105,5142,36685,185.29,3485.08,3836,36519.37
CU 0104106,5143,26246,598.49,0,14712.6,12131.89
CU 0104107,5144,17500,598.49,0,1750,16348.49
CU 0104110,5146,40575,185.29,0,0,40760.29
CU 0100984,"5148, 5149",109550,598.49,0,3500.01,106648.48
CU 0103262,5150,18600,185.29,0,1088.82,17696.47
CU 0104113,5155,30050,185.29,2659.43,3005,29889.72
CU 0104118,5160,25596,185.29,0,25684.2,97.09
CU 0104120,5164,46237,598.49,0,4598.7,42236.79
CU 0104121,5165,27750,185.29,0,2665,25270.29
CU 0104122,5166,30633,185.29,0,1750,29068.29
CU 0103472,5095,28850,185.29,0,8668.79,20366.5
CU 0104123,5167,40448,598.49,0,3954.8,37091.69
CU 0102290,5168,30798,598.49,0,6382.26,25014.23
CU 0104125,5171,17500,185.29,1548.75,1750,17484.04
CU 0104126,"5172, 5178",45400,185.29,0,4540,41045.29
CU 0104127,5173,22950,185.29,0,2295,20840.29
CU 0104128,5176,17500,185.29,0,1750,15935.29
CU 0104129,5177,17500,598.49,0,1750,16348.49
CU 0104130,5179,40160,598.49,0,0,40758.49
CU 0104131,5182,17500,598.49,0,0,18098.49
CU 0102752,"5185, 5186, 5187",89157,185.29,7890.39,18769.39,78463.29
CU 0104136,5189,39665,598.49,0,3939.5,36323.99
CU 0104138,5195,34521,185.29,3055.11,1750,36011.4
CU 0104137,"5190, 5191, 5192, 5193, 5198, 5199",270458,598.49,0,27774.93,243281.56
CU 0104139,5200,38675,598.49,0,3867.5,35405.99
CU 0101153,5201,29475,598.49,0,2521.98,27551.51
CU 0104140,5202,17500,185.29,0,1750,15935.29
CU 0104142,5205,18000,598.49,0,1800,16798.49
CU 0104143,5207,18750,185.29,1659.38,1875,18719.67
CU 0104146,5210,17500,185.29,0,1750,15935.29
CU 0104148,5212,20950,185.29,1854.08,22692.04,297.33
CU 0103905,4867,33125,598.49,0,4000,29723.49
CU 0104154,5228,24498,598.49,0,2449.8,22646.69
CU 0104156,5229,17500,598.49,0,1750,16348.49
CU 0104159,5231,43962,598.49,0,4396.2,40164.29
CU 0104171,"5246, 5247",37500,598.49,0,3713,34385.49
CU 0104178,5253,33875,185.29,0,3387.5,30672.79
CU 0104179,5254,21200,185.29,0,2120,19265.29
CU 0101291,5277,69738,598.49,0,211.02,70125.47
CU 0104114,5156,23551,185.29,0,2355.1,21381.19
CU 0104116,"5157, 5158",35000,598.49,0,3500,32098.49
CU 0104117,5159,24370,598.49,0,2437,22531.49
CU 0104124,5169,17500,598.49,0,1750,16348.49
CU 0100206,"5174, 5175",71950,185.29,0,4350,67785.29
CU 0104132,5183,32475,598.49,0,3247.5,29825.99
CU 0104133,5184,27417,598.49,0,2651.7,25363.79
CU 0104134,5188,24996,598.49,0,0,25594.49
CU 0103388,5203,20500,185.29,1814.25,0,22499.54
CU 0104141,5204,22670,598.49,0,23268.49,0
CU 0104145,5209,18000,185.29,0,1800,16385.29
CU 0104150,"5214, 5215, 5216",87130,598.49,0,6945,80783.49
CU 0104151,5218,17500,185.29,1548.75,1750,17484.04
CU 0104152,5225,32650,185.29,0,32835.29,0
CU 0104157,5230,24700,185.29,0,2470,22415.29
CU 0104169,5245,18000,185.29,1593,1800,17978.29
CU 0104182,"5265, 5288",55033,598.49,0,0,55631.49
CU 0104199,5285,37175,598.49,0,3717.5,34055.99
CU 0104200,5286,27237,598.49,0,2703.7,25131.79
CU 0104202,5290,37800,598.49,0,0,38398.49
CU 0100671,5291,29100,598.49,0,13573.65,16124.84
CU 0104204,5292,17500,598.49,0,1750,16348.49
CU 0102078,"5293, 5294",60510,598.49,0,0,61108.49
CU 0104207,5295,24619,185.29,2178.78,2506.5,24476.57
CU 0102817,5181,27100,598.49,0,7232.04,20466.45
CU 0104144,5208,32900,598.49,0,3290,30208.49
CU 0104164,5241,17500,185.29,0,1750,15935.29
CU 0104172,5248,33995,185.29,0,3399.5,30780.79
CU 0104173,5249,17500,185.29,0,1750,15935.29
CU 0104175,5250,17500,185.29,1548.75,1750,17484.04
CU 0104176,5252,25360,185.29,0,2536,23009.29
CU 0104180,5256,37747,185.29,3340.61,0,41272.9
CU 0102946,5257,32252,598.49,0,5515.93,27334.56
CU 0104184,5269,22200,185.29,0,2220,20165.29
CU 0104208,5296,35675,185.29,0,3537.5,32322.79
CU 0104210,5299,21885,185.29,0,2253.68,19816.61
CU 0104211,5303,26548,598.49,0,0,27146.49
CU 0104214,5308,22773,598.49,0,2277.3,21094.19
CU 0103318,"5313, 5314",54900,185.29,0,5633.96,49451.33
CU 0104217,5315,32888,598.49,0,3288.8,30197.69
CU 0104218,5317,45925,598.49,0,0,46523.49
CU 0104225,"5325, 5326",35000,598.49,0,1750,33848.49
CU 0104119,5163,26425,598.49,0,2642.5,24380.99
CU 0104147,5211,25885,598.49,0,1750,24733.49
CU 0104149,5213,36969,185.29,3271.76,43385.36,-2959.31
CU 0104183,5266,37474,598.49,0,3747.4,34325.09
CU 0104212,"5304, 5305",35000,185.29,3325,3500,35010.29
CU 0104181,5264,17500,598.49,0,1750,16348.49
EOF


# Bomb Squad
data2 = <<EOF
CU 0101868,Chad
CU 0101721,Travis
EOF



# These accounts missed in given data
missed_accounts = <<EOF
CU 0102495
EOF

data = FasterCSV.parse( data )
data.shift # the header in not required

data.each do |line|
  account_num = line.first
  # Customer,   Camera,       SubTotal, Shipping, Tax,     Balance, Transfer Amt
  # CU 0100718, "3037, 3038", 51040.00, 185.29,   4517.04, 4254.03, 51488.30
  begin
    cust = ERP::Customer.find_by_account_num( account_num )
    cust.subtotal = line[2]
    cust.shipping = line[3]
    cust.tax = line[4]
    cust.balance = line[5]
    cust.transfer_amount = line[6]
    cust.to_transfer = line[6]
    
    # Set the shipping methods
    if cust.shipping_method.blank?
        if line[3] == '598.49'
          cust.shipping_method = 'Shipping (FedEx International Priority) and Handling'
        elsif line[3] == '185.29'
          cust.shipping_method = 'Shipping (FedEx 2 Day Air) and Handling'
        end
    end
    
    cust.save!
  rescue
    puts "Failed to update: #{account_num}"
  end
  
end


#这个是要更新客服的列表
# data2 = FasterCSV.parse( data2 )
# 
# data2.each do |line|
#   account_num = line.first
#   # Customer,   Camera,       SubTotal, Shipping, Tax,     Balance, Transfer Amt
#   # CU 0100718, "3037, 3038", 51040.00, 185.29,   4517.04, 4254.03, 51488.30
#   # begin
#     cust = ERP::Customer.find_by_account_num( account_num )
# # 如果客服的已经被分配，那就不要更新
#     if cust.assigned_to.blank? || cust.assigned_to == 'Kadar' || cust.assigned_to == 'Randy' || cust.assigned_to == 'Stift' || cust.assigned_to == 'BrianK' 
#     cust.assigned_to = line[1]
#     cust.save!
#     end
#   # rescue
#   #   puts "Failed to update: #{account_num}"
#   # end
#   
# end

# 自定义客户指定的客服人员
# data3 = <<EOF
# CU 0103625,Brent
# CU 0103626,Brent
# CU 0100713,Brent
# CU 0103627,Brent
# CU 0103624,Brent
# CU 0101004,Kelly
# CU 0103808,Kelly
# CU 0103809,Kelly
# CU 0103810,Kelly
# CU 0103811,Kelly
# CU 0100397,Polo
# EOF
# 
# data3 = FasterCSV.parse( data3 )
# 
# data3.each do |line|
#   account_num = line.first
#   # Customer,   Camera,       SubTotal, Shipping, Tax,     Balance, Transfer Amt
#   # CU 0100718, "3037, 3038", 51040.00, 185.29,   4517.04, 4254.03, 51488.30
#   begin
#     cust = ERP::Customer.find_by_account_num( account_num )
# # 如果客服的已经被分配，那就不要更新
#     cust.assigned_to = line[1]
#     cust.save!
#   rescue
#     puts "Failed to update: #{account_num}"
#   end
#   
# end
# 

